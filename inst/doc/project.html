<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mark van der Loo" />

<meta name="date" content="2022-06-16" />

<title>Introduction to the Successive Projection Algorithm</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to the Successive Projection Algorithm</h1>
<h4 class="author">Mark van der Loo</h4>
<h4 class="date">2022-06-16</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#example">Example</a></li>
<li><a href="#optimization-in-r">Optimization in R</a></li>
</ul></li>
<li><a href="#sparse-problems">Sparse problems</a><ul>
<li><a href="#reusing-sparsely-defined-restrictions">Reusing sparsely defined restrictions</a></li>
</ul></li>
<li><a href="#references">References</a></li>
<li><a href="#some-words-on-the-rspa-package">Some words on the rspa package</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The successive projection algorithm (SPA) solves quadratic optimization problems under linear equality and inequality restrictions. That is, given a vector <span class="math inline">\(\boldsymbol{x}\)</span>, find the vector <span class="math inline">\(\boldsymbol{x}^*\)</span> that minimizes the weighted Euclidian distance <span class="math display">\[
(\boldsymbol{x}-\boldsymbol{x}^*)^T\boldsymbol{W}(\boldsymbol{x}-\boldsymbol{x}^*),
\]</span> subject to <span class="math display">\[
\boldsymbol{Ax}^*\leq \boldsymbol{b}.
\]</span> Here, <span class="math inline">\(\boldsymbol{W}\)</span> is a diagonal matrix with positive weights. The system of restrictions can contain equality and/or inequality restrictions.</p>
<div id="example" class="section level3">
<h3>Example</h3>
<p>Suppose we have the vecor <span class="math inline">\((x,y)=(0.8,-0.2)\)</span>, depicted by the black dot in the figure below. Furthermore, we have the demands that</p>
<p><span class="math display">\[
\begin{array}{lcl}
 y &amp;\geq&amp; x\\
 x &amp;\geq&amp; 1-y
\end{array}
\]</span> The regions where <span class="math inline">\(y\geq x\)</span> or <span class="math inline">\(x\geq 1-y\)</span> are indicated by the single-shaded regions in the figure. The area where both demands are satisfied is indicated by the doubly-shaded region.</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>To find a solution, the successive projection algorithm projects the start vector iterativelty on the borders of the convex region that is defined by the linear inequalities. In the figure this is indicated by the arrows. The solution is a point on or numerically very near the border of the allowed region.</p>
<p>When all weights on the diagonal of <span class="math inline">\(\boldsymbol{W}\)</span> are equal, projections are orthogonal, as shown in the figure. If the weights differ, the direction of projections will be scaled accordingly.</p>
</div>
<div id="optimization-in-r" class="section level3">
<h3>Optimization in R</h3>
<p>In the <code>lintools</code> package, all inequalities must be written in the <span class="math inline">\(\leq\)</span>-form. So first note that the above constraints can be written as <span class="math display">\[
\left(\begin{array}{cc}
1 &amp; -1\\
1 &amp; 1\\
\end{array}\right)
\left(\begin{array}{c}
x\\y
\end{array}\right)
\leq
\left(\begin{array}{c}
0\\
1
\end{array}\right)
\]</span></p>
<p>So we formulate the problem with the <code>lintools</code> package as follows.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(lintools)</a>
<a class="sourceLine" id="cb1-2" title="2">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.8</span>,<span class="op">-</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb1-3" title="3">A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">byrow=</span><span class="ot">TRUE</span>, <span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>)</a></code></pre></div>
<p>The function <code>project</code> solves the problem for us. By passing <code>neq=0</code> we tell <code>project</code> that every restriction is an inequality (setting <code>neq&gt;0</code> means that the first <code>neq</code> restrictions are equalities).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">project</span>(<span class="dt">x=</span>x,<span class="dt">A=</span>A,<span class="dt">b=</span>b,<span class="dt">neq=</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## $x
## [1] 0.5 0.5
## 
## $status
## [1] 0
## 
## $eps
## NULL
## 
## $iterations
## [1] 2
## 
## $duration
##    user  system elapsed 
##       0       0       0 
## 
## $objective
## [1] 0.7615773</code></pre>
<p>The result is a list with the following elements.</p>
<ul>
<li><code>x</code> : the optimized vector</li>
<li><code>status</code>: A status indicator: 0 means that the algorithm converged to a solution. (1= not enough memory, 2= divergence detected, 3 = maximum nr of iterations exceeded)</li>
<li><code>tol</code> A measure of how far the final vector lies from the borders defined by the constaint (it is the <span class="math inline">\(L_\infty\)</span> distance to the valid region).</li>
<li><code>iterations</code> The number of iterations performed.</li>
<li><code>duration</code> The amount of time elapsed during optimization.</li>
<li><code>objective</code> This is the weighted distance between the start vector and the solution.</li>
</ul>
</div>
</div>
<div id="sparse-problems" class="section level2">
<h2>Sparse problems</h2>
<p>For problems where a great many coeffiecients need to be optimized under a large number of restrictions, it is possible to forumate the restrictions in sparse format.</p>
<p>In the <code>lintools</code> package, the row-column-coefficient format is used. That is, in stead of defining the full matrix <span class="math inline">\(\boldsymbol{A}\)</span> as in the previous example, we set up a <code>data.frame</code> with columns</p>
<ul>
<li><code>row</code> : the row number</li>
<li><code>column</code>: the column number</li>
<li><code>coef</code> : the coefficient</li>
</ul>
<p>Of course, only non-zero coefficients need to be listed.</p>
<p>As a -rather simple- example, we define the same problem as above, but now in a sparse manner.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">A &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="dt">row =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-3" title="3">  ,<span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-4" title="4">  ,<span class="dt">coef =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-5" title="5">)</a>
<a class="sourceLine" id="cb4-6" title="6">b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-7" title="7">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.8</span>,<span class="op">-</span><span class="fl">0.2</span>)</a></code></pre></div>
<p>Solving is done with the <code>sparse_project</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">sparse_project</span>(x, <span class="dt">A=</span>A, <span class="dt">b=</span>b, <span class="dt">neq=</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## $x
## [1] 0.5 0.5
## 
## $status
## [1] 0
## 
## $eps
## NULL
## 
## $iterations
## [1] 3
## 
## $duration
##    user  system elapsed 
##       0       0       0 
## 
## $objective
## [1] 0.7615773</code></pre>
<p>We have been able to solve problems with up to <span class="math inline">\(\sim\)</span> 6 milion variables and hundreds of thousands of linear (in)equality restrictions with the algorithm as implemented in this package.</p>
<div id="reusing-sparsely-defined-restrictions" class="section level3">
<h3>Reusing sparsely defined restrictions</h3>
<p>The <code>sparse_project</code> function performs the following steps:</p>
<ol style="list-style-type: decimal">
<li>It creates a particular sparse representation of the restrictions</li>
<li>It solves the minimization problem</li>
<li>It gathers results and returns them to the user.</li>
</ol>
<p>Step 1 takes a little bit of time (not much) but if you need to do a lot of optimizations it may pay to do it once and reuse the representation. This can be done as follows, using the same definition of sparse constraints as in the previous subsection.</p>
<p>First, create an object of class <code>sparse_constraints</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">sc &lt;-<span class="st"> </span><span class="kw">sparse_constraints</span>(A,b,<span class="dt">neq=</span><span class="dv">0</span>)</a></code></pre></div>
<p>Now, using its <code>project</code> method, we can optimize from multiple starting points, for example:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">sc<span class="op">$</span><span class="kw">project</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="fl">0.8</span>,<span class="op">-</span><span class="fl">0.2</span>))</a></code></pre></div>
<pre><code>## $x
## [1] 0.5 0.5
## 
## $status
## [1] 0
## 
## $eps
## NULL
## 
## $iterations
## [1] 3
## 
## $duration
##    user  system elapsed 
##       0       0       0 
## 
## $objective
## [1] 0.7615773</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># the same problem, but with differing weights</span></a>
<a class="sourceLine" id="cb10-2" title="2">sc<span class="op">$</span><span class="kw">project</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="fl">0.8</span>,<span class="op">-</span><span class="fl">0.2</span>),<span class="dt">w=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>))</a></code></pre></div>
<pre><code>## $x
## [1] 0.5040358 0.4959642
## 
## $status
## [1] 0
## 
## $eps
## NULL
## 
## $iterations
## [1] 26
## 
## $duration
##    user  system elapsed 
##       0       0       0 
## 
## $objective
## [1] 2.220643</code></pre>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>The algorithm implemented here may have been invented a number of times. The earliest reference known to this author is</p>
<ul>
<li>Hildreth, C. (1957), A quadratic programming procedure. <em>Naval research logistics quarterly</em> 4, pp 79-85.</li>
</ul>
<p>The method was more recently discussed in the context of restricted imputation methodology by</p>
<ul>
<li>Pannekoek, J. and Zhang, L.-C. (2012), Optimal adjustments for inconsistency in imputed data. _<a href="https://www.cbs.nl/-/media/imported/documents/2012/38/2012-19-x10-pub.pdf">Discussion Paper 201219</a> Statistics Netherlands.</li>
</ul>
</div>
<div id="some-words-on-the-rspa-package" class="section level2">
<h2>Some words on the rspa package</h2>
<p>Users of the <code>rspa</code> package will no doubt recognize the algorithm and the <code>sparse_constraints</code> object. We chose to separate the functionality from <code>rspa</code> to be able to reuse the successive projection algorithm for multiple purposes, without depending on the <code>editrules</code> package. In the future, <code>rspa</code> will depend on <code>lintools</code> with guaranteed backward compatibility.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
